<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="创新实践服务外包O2O资源回收平台">
    <meta name="author" content="zy">
    <link rel="icon" href="./images/icon.ico">

    <title>我要出售</title>

    <!--         CSS          -->
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/font-awesome.min.css">
    <link rel="stylesheet" href="./css/bootstrap-datetimepicker.min.css">
    <link rel="stylesheet" href="./css/skins/square/blue.css">
    <link rel="stylesheet" href="./css/buttons.css">
    <!--         JS           -->
    <script src="./js/jquery-3.3.1.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
    <script src="./js/bootstrap-datetimepicker.min.js"></script>
    <script src="./js/icheck.min.js"></script>
    <script src="./js/buttons.js"></script>
</head>

<body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false"
                    aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <img src="./images/icon.ico" class="my-bar-icon">
                <a href="#" class="navbar-brand" style="color: #eee;">我要出售</a>
            </div>
            <div id="navbar" class="collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li>
                        <a href="index.html">主页</a>
                    </li>
                    <li class="active">
                        <a href="sell.html">我要出售</a>
                    </li>
                    <li>
                        <a href="recover.html">我要回收</a>
                    </li>
                    <li>
                        <a href="orders.html">我的订单</a>
                    </li>
                    <li>
                        <a href="wallet.html">我的钱包</a>
                    </li>
                    <li>
                        <a href="personal-center.html">个人中心</a>
                    </li>
                    <li>
                        <a href="about.html">关于</a>
                    </li>
                    <li>
                        <a href="login.html">登录</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="wrapper">
        <div class="container sell">
            <div class="row">
                <div class="title-re">
                    <h2>我要出售</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-1 col-xs-offset-1">
                    <h3>
                        <i class="fa fa-clock-o fa-1x"></i>
                    </h3>
                </div>
                <div class="col-xs-6">
                    <h3>
                        预约时间
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-10 col-xs-offset-1">
                    <div class="input-append date form_datetime">
                        <input size="39" type="text" id="date" readonly>
                        <span class="add-on">
                            <i class="icon-th"></i>
                        </span>
                    </div>
                </div>
            </div>
            <div class="row pd">
                <div class="col-xs-1 col-xs-offset-1">
                    <h3>
                        <i class="fa fa-building-o fa-1x"></i>
                    </h3>
                </div>
                <div class="col-xs-6">
                    <h3>
                        地址选择
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-10 col-xs-offset-1">
                    <select class="form-control" id="father" value="temp">
                        <option value="temp" id="addTemplate">123123</option>
                    </select>
                    <script>
                        $.get('/getaddresses', function (data) {
                            var n = data.addresses.length;
                            //添加address模块；
                            var tmp = $("#addTemplate");
                            for (var i = 0; i < n; i++) {
                                var newtmp = tmp.clone();
                                newtmp.attr('id', 'addrson' + i);
                                $("#father").append(newtmp);
                                $(`#${"addrson" + i}`).text(`${data.addresses[i].address+' '+data.addresses[i].name+' '+data.addresses[i].tel}`);
                                $(`#${"addrson" + i}`).val(data.addresses[i].add_id);
                            }
                            tmp.remove();
                        });
                    </script>
                </div>
            </div>
            <div class="row pd">
                <div class="col-xs-1 col-xs-offset-1">
                    <h3>
                        <i class="fa fa-shopping-basket fa-1x"></i>
                    </h3>
                </div>
                <div class="col-xs-6">
                    <h3>
                        回收物品
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-10 col-xs-offset-1">
                    <div class="row">
                        <div class="col-xs-5">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type1" value="废旧金属" name="test"> 废旧金属
                                </label>
                            </div>
                        </div>
                        <div class="col-xs-5 col-xs-offset-1">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type2" value="废纸" name="test"> 废纸
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-10 col-xs-offset-1">
                    <div class="row">
                        <div class="col-xs-5">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type3" value="电子废品" name="test"> 电子废品
                                </label>
                            </div>
                        </div>
                        <div class="col-xs-5 col-xs-offset-1">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type4" value="废旧家具" name="test"> 废旧家具
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-10 col-xs-offset-1">
                    <div class="row">
                        <div class="col-xs-5">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type5" value="废旧塑料" name="test"> 废旧塑料
                                </label>
                            </div>
                        </div>
                        <div class="col-xs-5 col-xs-offset-1">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type6" value="废旧衣物" name="test"> 废旧衣物
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-10 col-xs-offset-1">
                    <div class="row">
                        <div class="col-xs-5">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type7" value="大型电器" name="test"> 大型电器
                                </label>
                            </div>
                        </div>
                        <div class="col-xs-5 col-xs-offset-1">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="type8" value="其他" name="test"> 其他
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row pd">
                <div class="col-xs-1 col-xs-offset-1">
                    <h3>
                        <i class="fa fa-comment fa-1x"></i>
                    </h3>
                </div>
                <div class="col-xs-6">
                    <h3>
                        备注信息
                    </h3>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-10 col-xs-offset-1">
                    <textarea class="form-control" rows="5" id="remark" placeholder="请按照回收物品信息填写备注信息，如：&#10废纸：废书两本；&#10电子废品：废旧电池两对；"></textarea>
                </div>
            </div>
            <div class="alert alert-danger alert-dismissible" role="alert" id="orderSubmitFailedAlert" hidden="hidden" style="margin-top: 5%">
                <p>
                    <strong>订单提交失败:
                        <span id="errorInfor"></span>
                    </strong>
                </p>
            </div>
            <div class="alert alert-success alert-dismissible" role="alert" id="orderSubmitSuccess" hidden="hidden" style="margin-top: 5%">
                <p>
                    <strong>订单提交成功
                    </strong>
                </p>
            </div>
            <div class="row pd pd-btm">
                <div class="col-xs-12">
                    <button onclick="orderSubmit()" type="button" class="button button-glow button-border button-rounded" style="width: 100%">
                        提交
                    </button>
                </div>
                <script>
                    function orderSubmit() {
                        obj = document.getElementsByName("test");
                        check_val = [];
                        for (k in obj) {
                            if (obj[k].checked)
                                check_val.push(obj[k].value);
                        }
                        var date = $("#date").val(), addr_id = $("#father").val(), type = check_val, detail = $('#remark').val();
                        //alert(remark);
                        $.post('/submitorder', { date: date, addr_id: addr_id, type: type, detail: detail }, function (data) {
                            if (data.code === 1) orderSubmitSuccess();
                            else orderSubmitFailedAlert(data.err);
                        })
                    }
                    function orderSubmitFailedAlert(err) {
                        $('#orderSubmitFailedAlert').removeAttr("hidden");
                        document.getElementById("errorInfor").innerHTML = err;
                    }
                    function orderSubmitSuccess(){
                        $('#orderSubmitFailedAlert').hide();
                        $('#orderSubmitSuccess').removeAttr("hidden");
                    }
                </script>
            </div>
        </div>
    </div>
</body>
<script>
    $(".form_datetime").datetimepicker({
        format: "yyyy-mm-dd hh:ii",
        autoclose: true,
        todayBtn: true,
        pickerPosition: "bottom-right"
    });
</script>
<script>
    $('input').iCheck({
        labelHover: false,
        cursor: true,
        checkboxClass: 'icheckbox_square-blue',
        radioClass: 'iradio_square-blue',
        increaseArea: '20%'
    });
</script>

</html>